var P=/^10.\d{4,9}\/[-._;()/:A-Z0-9]+$/i;function s(e){return e?e.match(P)!==null:!1}var w={test(e){return!!e.hostname.match(/(?:dx\.)?(?:www\.)?doi\.org/)},parse(e){return e.pathname.replace(/^\//,"")}},j={test(e){return e.hostname.endsWith("elifesciences.org")&&e.pathname.startsWith("/articles/")},parse(e){return`10.7554/eLife.${e.pathname.replace("/articles/","")}`}},C={test(e){return e.hostname.endsWith("zenodo.org")&&!!e.pathname.match(/^\/(?:record|badge\/latestdoi)\//)},parse(e){return`10.5281/zenodo.${e.pathname.replace(/^\/(?:record|badge\/latestdoi)\//,"")}`}},M={test(e){return e.hostname.endsWith("biorxiv.org")&&!!b(e).find(s)},parse(e){var r;return(r=b(e).find(s))===null||r===void 0?void 0:r.replace(/v([\d]*)$/,"")}};function b(e){let r=e.pathname.split("/").filter(n=>!!n);return r.slice(0,-1).map((n,t)=>`${n}/${r[t+1]}`)}var q={test(e){return!!b(e).find(s)},parse(e){return b(e).find(s)}},B={test(e){return s(e.searchParams.get("id"))},parse(e){var r;return(r=e.searchParams.get("id"))!==null&&r!==void 0?r:void 0}},A=[w],T=[w,M,q,j,C,B];var z="10.13039";function V(e,r){return e?!!$(e,r):!1}function $(e,r){let n;if(e){if(s(e))return e;if(e.startsWith("doi:")&&(n=e.slice(4),s(n)))return n;try{let t=new URL(e.startsWith("http")?e:`http://${e}`),l=A.find(u=>u.test(t)),a=T.find(u=>u.test(t));if(r?.strict&&!l)return;let o=l??a;if(!o)return;if(n=o.parse(t),!r?.strict&&l)return n}catch{}if(s(n))return n}}function G(e,r){let n=$(e,r);if(n)return`https://doi.org/${n}`}function Y(e){let r=$(e);return r?r.startsWith(`${z}/`):!1}var ue={validatePart:s,validate:V,normalize:$,buildUrl:G,isOpenFunderRegistry:Y};function D(e){if(e==null)return new Date;if(e instanceof Date)return e;if(typeof e=="string")return new Date(e);if(e?.toDate!==void 0)return e.toDate();throw new Error(`Could not parse date: ${e}`)}function _(e){return e instanceof Date?e.toISOString():e?.toDate!==void 0?e.toDate().toISOString():typeof e=="string"?_(D(e)):null}function f(e){return e!=null}function L(e){return e.file&&e.location?` (at ${e.file}#${e.location})`:e.file||e.location?` (at ${e.file||e.location})`:""}function g(e,r){let n=r.property;return r.location&&(n=`${r.location}.${r.property}`),{...r,property:e,location:n}}function d(e,r){if(r.suppressErrors)return;let{messages:n}=r;n.errors||(n.errors=[]);let t=`'${r.property}' ${e}${L(r)}`;n.errors.push({property:r.property,message:t}),r.errorLogFn&&r.errorLogFn(t)}function m(e,r){if(r.suppressWarnings)return;let{messages:n}=r;n.warnings||(n.warnings=[]);let t=`'${r.property}' ${e}${L(r)}`;n.warnings.push({property:r.property,message:t}),r.warningLogFn&&r.warningLogFn(t)}function R(e,r){if(typeof e=="string"){if(e.toLowerCase()==="true")return!0;if(e.toLowerCase()==="false")return!1}return e===!0||e===!1?e:d("must be boolean",r)}function N(e,r){let n=Number(e);return Number.isNaN(n)?d(`must be a number: ${e}`,r):f(r.min)&&n<r.min?d(`must be greater than or equal to ${r.min}: ${n}`,r):f(r.max)&&n>r.max?d(`must be less than or equal to ${r.max}: ${n}`,r):r.integer&&!Number.isInteger(n)?d(`must be an integer: ${n}`,r):n}function x(e,r){let n=e;return r.coerceNumber&&typeof n=="number"&&(Number.isNaN(n)&&m("is not a number",r),n=String(n)),typeof n!="string"?d("must be string",r):r.maxLength&&n.length>r.maxLength?d(`must be less than ${r.maxLength} chars`,r):r.regex&&!n.match(r.regex)?d(`must match regex ${r.regex}`,r):(r.escapeFn&&(n=r.escapeFn(n)),n)}function Z(e,r){let n=x(e,{...r,maxLength:2048});if(n===void 0)return n;let t;try{t=new URL(n)}catch{return d(`must be valid URL: ${n}`,r)}return r.includes&&!t.origin.includes(r.includes)?d(`must include "${r.includes}": ${n}`,r):n}function H(e,r){let n=x(e,r);return n===void 0||n.toLowerCase().match(/^(([^<>()[\]\\.,;:\s@"]+(\.[^<>()[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/)?n:d(`must be valid email address: ${n}`,r)}function Q(e,r){return r.choices.includes(e)?e:d(`invalid value '${e}' - must be one of [${r.choices.join(", ")}]`,r)}function X(e,r){return Object.values(r.enum).includes(e)?e:d(`invalid value '${e}' - must be one of [${Object.values(r.enum).join(", ")}]`,r)}function J(e,r){let n=new Date(e);return n.getDate()?typeof e=="string"?e:_(n):d(`invalid date "${e}" - must be ISO 8601 format or IETF timestamp`,r)}function I(e,r){return typeof e!="object"?d("must be object",r):Array.isArray(e)?d("must be object, not array",r):e}function K(e,r,n){var t;let l={},a=r.required||[],o=r.optional||[],u=Object.entries((t=r.alias)!==null&&t!==void 0?t:{}).filter(i=>a.includes(i[1])||o.includes(i[1])).map(i=>i[0]),c=[];if(Object.keys(e).forEach(i=>{var v;if(a.includes(i)||o.includes(i))l[i]=e[i],a=a.filter(h=>h!==i);else if(u.includes(i)){let h=(v=r.alias)===null||v===void 0?void 0:v[i];e[h]===void 0?(l[h]=e[i],a=a.filter(F=>F!==h)):m(`both "${h}" and "${i}" were provided, "${i}" was ignored.`,n)}else c.push(i),n.keepExtraKeys&&(l[i]=e[i])}),!(a.length&&(d(`missing required key${a.length>1?"s":""}: ${a.join(", ")}`,n),!n.returnInvalidPartial)))return c.length&&m(`extra key${c.length>1?"s":""} ignored: ${c.join(", ")}`,n),l}function E(e,r,n){let t=I(e,n);if(t!==void 0)return K(t,r,n)}function k(e,r,n){let t;if(Array.isArray(e))t=e;else if(r.coerce)t=[e];else return d("must be an array",r);return t.map((l,a)=>n(l,a)).filter(l=>l!==void 0)}function y(e,r,n){let t={...e};return n.forEach(l=>{if(!f(t[l])&&f(r[l])){let a=l;t[a]=r[a]}}),t}function ee(e,r){return y({},e,r)}var p=["enumerator","all","headings"],O=["heading_1","heading_2","heading_3","heading_4","heading_5","heading_6"],re=["figure","subfigure","equation","subequation","table","code",...O],U=["enabled","start","template"],ne={sections:"headings",h1:"heading_1",h2:"heading_2",h3:"heading_3",h4:"heading_4",h5:"heading_5",h6:"heading_6",heading1:"heading_1",heading2:"heading_2",heading3:"heading_3",heading4:"heading_4",heading5:"heading_5",heading6:"heading_6"};function W(e){return typeof e=="string"?["true","false"].includes(e.toLowerCase()):typeof e=="boolean"}function S(e,r){var n,t;W(e)?e={enabled:e}:typeof e=="number"?e={start:e}:typeof e=="string"&&(e={template:e});let l=E(e,{optional:U},r);if(l===void 0)return;let a={};if(f(l.enabled)){let o=R(l.enabled,g("enabled",r));f(o)&&(a.enabled=o)}if(f(l.start)){let o=N(l.start,{...g("start",r),integer:!0,min:1});o&&(a.start=o,a.enabled=(n=a.enabled)!==null&&n!==void 0?n:!0)}if(f(l.template)){let o=x(l.template,g("template",r));f(o)&&(a.template=o,a.enabled=(t=a.enabled)!==null&&t!==void 0?t:!0)}if(Object.keys(a).length!==0)return a}function be(e,r){var n,t,l,a;W(e)&&(e={all:e});let o=E(e,{optional:[...re,...p],alias:ne},{...r,suppressWarnings:!0,keepExtraKeys:!0});if(o===void 0)return;let u={},c;if(f(o.enumerator)){let i=g("enumerator",r);u.enumerator=S(o.enumerator,i),((n=u.enumerator)===null||n===void 0?void 0:n.enabled)!=null&&(u.enumerator.enabled!==!0&&m("value for 'enabled' is ignored",i),delete u.enumerator.enabled),((t=u.enumerator)===null||t===void 0?void 0:t.start)!=null&&(m("value for 'start' is ignored",i),delete u.enumerator.start)}if(f(o.all)){let i=g("all",r);u.all=S(o.all,i),((l=u.all)===null||l===void 0?void 0:l.template)!=null&&(m("value for 'template' is ignored",i),delete u.all.template),((a=u.all)===null||a===void 0?void 0:a.start)!=null&&(m("value for 'start' is ignored",i),delete u.all.start)}if(f(o.headings)&&(c=S(o.headings,g("headings",r)),O.forEach(i=>{c&&!f(o[i])&&(o[i]=c)})),Object.keys(o).filter(i=>!p.includes(i)).forEach(i=>{if(f(o[i])){let v=S(o[i],g(i,r));if(!f(v))return;c&&O.includes(i)?u[i]={...c,...v}:u[i]=v}}),Object.keys(u).length!==0)return u}function $e(e,r){let n={...r,...e};return Object.entries(r??{}).filter(([t])=>!p.includes(t)).forEach(([t,l])=>{var a,o,u;n[t]=y((a=e?.[t])!==null&&a!==void 0?a:{},{...l,enabled:(u=(o=e?.all)===null||o===void 0?void 0:o.enabled)!==null&&u!==void 0?u:l.enabled},U)}),n}export{f as a,g as b,d as c,m as d,R as e,N as f,x as g,Z as h,H as i,Q as j,X as k,J as l,I as m,K as n,E as o,k as p,ee as q,ue as r,be as s,$e as t};
